\section{Methods}

\subsection{Population}

This study selects the entire cohort of Norwegian Year 10 students graduating in 2019 as its targeted population. Students' GPA (\textit{grunnskolepoeng}), teacher-assigned grades (\textit{standpunktkarakter}), as well as written (\textit{SKR}) and oral (\textit{MUN}) exam grades were extracted from the Norwegian register. This data source is unique because it is the \emph{population}, not a sample, that is the subject of our study.

Attainment records were subsequently re-formatted with each row representing one candidate and each column being one subject, leading to 64,918 students and 200 subjects. Students without valid GPA records were removed from the data set (data loss $n^-= 4,300$ cases, loss rate $r^- = 6.62\%$).

Under the Norwegian education system, students shall complete 13 compulsory subjects as well as electives. For teacher-assigned grades, this study focuses on these compulsory subjects with one exclusion ``Sidem{\aa}l''.\footnote{Norway has two official written language forms: Bokm{\aa}l and Nynorsk, with the former being the dominant form in national media. Students growing up in one written form must enroll the other as their Sidem{\aa}l, unless Norwegian is not their native language. Nynorsk users tend to have easier time in Sidem{\aa}l due to existing exposure to Bokm{\aa}l. Bokm{\aa}l users, on the other hand, find Nynorsk more challenging while fulfilling Sidem{\aa}l. Since this subject contains two sub-cohorts with very different difficulty profiles, we opt not to include Sidem{\aa}l in our analyses.} We applied equal treatment to courses instructed in Norwegian and in Sami language by merging these records.\footnote{If academic results from both instruction languages were available, we retain the higher grades during merging.} Twelve teacher-assigned grades were retained for our analysis: Written Norwegian (NORW), Oral Norwegian (NORO), Written English (ENGW), Oral English (ENGO), Mathematics (MATH), Natural Sciences (NATS), Social Sciences (SOCS), Religion (RELI), Music (MUSI), Arts and Handcraft (HAND), Food and Health (FOOD), and Physical Education (PHED).

At this stage, the existence of missing data no longer poses any problems for our analyses thanks to sufficient overlap across subjects in the score matrix. The ability to deal with incomplete data is one major advantage of using the Rasch model for studying inter-subject comparability \parencite{he:2018}.

\subsubsection{Generalised Partial Credit Model (GPCM)}

A unidimensional generalised partial credit model \parencite{muraki:1992} with the probability that Candidate $n$'s score in Subject $i$ ($x_{ni}$) being Grade $j$ ($j=0, \dots, m$) is given by
\begin{equation}\label{eqn:gpcm}
    p \left( x_{ni}=j | d_{ni} = 1; \theta_n \right) = \frac{\exp{j \alpha_i \theta_n - \sum_{h=1}^j \beta_{ih}} }{ 1 + \sum_{h=1}^m \exp{h \alpha_i \theta_n - \sum_{k=1}^h \beta_{ik}} },
\end{equation}
where $\theta_n$ is the unidimensional proficiency parameter that represents the overall proficiency of Candidate $n$.

\subsubsection{Log-likelihood}

In MML, a likelihood function ($\ell$) is maximised where the candidates' proficiency parameters ($\theta$) are integrated out of the likelihood. The marginal log-likelihood for a unidimensional GPCM is given by
\begin{equation}\label{eqn:ll}
    \ell_\text{unidimensional} = \sum_p \sum_{n | p} \log \int \prod_i p( x_{ni} | d_{ni}; \theta ) g(\theta; \mu_p, \sigma^2) \dd \theta,
\end{equation}
where $x_{ni}$ is the observed grade, $p( \cdot )$ is equal to \cref{eqn:gpcm} evaluated at $x_{ni}$ if $d_{ni}=1$, and $p( \cdot ) = 1$ if $d_{ni} = 0$. In addition, $g(\theta; \mu_p, \sigma^2)$ is the normal pdf with mean $\mu_p$ and variance $\sigma^2$. The model can be identified by choosing a standard normal $\mathcal{N}(0,1)$ \parencite{korobko:2008}.

\subsubsection{Multidimensionality}

There exists strong believes among educational scientists that learners' proficiency is multidimensional, such as one proficiency factor for STEM subjects, for example, and another one for languages. If $F$ proficiency dimensions are required to model the grades, the proficiency can be represented by a vector of proficiency parameters $\m{\theta}_n=\left(\theta_{n1}, \cdots, \theta_{nF}\right)\Ts$ with the corresponding GPCM:
\begin{equation}\label{eqn:mgpcm}
    p \left( x_{ni} = j | d_{ni} = 1; \m{\theta}_n \right) =
    \frac{ \exp{ j \left( \sum_{f=1}^F \alpha_{if} \theta_{nf} \right) - \sum_{h=1}^j \beta_{ih} } }{ 1 + \sum_{h=1}^m \exp{ h \left( \sum_{f=1}^F \alpha_{if} \theta_{nf} \right) - \sum_{k=1}^h \beta_{ik} } }.
\end{equation}
with $\m{\theta}_n$ following a multivariate normal distribution with mean $\m{\mu}_p$ and variance-covariance matrix $\m{\Sigma}$. Similar to the unidimensional case, \cref{eqn:mgpcm} is identified by setting $\m{\mu}_p=\m{0}$ and $\m{\Sigma} = \m{I}$ the identity matrix. The log-likelihood of a multidimensional GPCM then becomes:
\begin{equation}\label{eqn:mll}
    \ell_\text{multidimensional} = \sum_{p} \sum_{n | p} \log \int \cdots \int \prod_i p( x_{ni} | d_{ni}; \m{\theta} ) g( \m{\theta}; \m{\mu}_p, \m{\Sigma} ) \dd \m{\theta},
\end{equation}
with each component sharing similar interpretations to the unidimensional counterpart in \cref{eqn:ll}.

\subsection{Interaction between Subject Choice and Proficiency}

Under the advisory of \textcite{korobko:2008}, a latent variable $\theta^+$ is introduced to reflect student's propensity of choosing a particular subject. Augmenting $\theta^+$ to $\m{\theta}=\left(\theta_1, \cdots, \theta_F\right)\Ts$ yields $\m{\theta}^+=\left(\theta_1, \cdots, \theta_F, \theta^+\right)\Ts$, with a corresponding marginal likelihood:
\begin{equation}\label{eqn:lli}
    \ell_\text{interaction} = \sum_p \sum_{ n | p} \log \int \cdots \int \prod_i \left[ p \left( x_{ni} | d_{ni}; \m{\theta} \right) p \left( d_{ni}; \theta^+ \right) \right] g(\m{\theta}^+; \m{\mu}_p, \m{\Sigma}) \dd \m{\theta}^+ .
\end{equation}

